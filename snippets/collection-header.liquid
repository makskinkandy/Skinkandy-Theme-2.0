<div class="collection-header-wrapper banner-section page-content">
  <div class="page-width">
    <header class="section-header">
      <h1 class="section-content__heading h1" style="color: {{ block.settings.title_color }}">{{ collection.title | escape }}</h1>

      {%- if collection.description != blank -%}
        <div class="section-content__text rte">
          {{ collection.description }}
        </div>
      {%- endif -%}
    </header>
    {% if block.settings.custom_filter_1 != blank or block.settings.custom_filter_2 != blank or block.settings.custom_filter_3 != blank %}
      <div class="custom-filter__wrapper">
        {% if block.settings.custom_filter_1 != blank %}
          <a class="ss__list__link btn btn--primary" href="{{ block.settings.custom_filter_1 }}">{{ block.settings.custom_filter_1_text }}</a>
        {% endif %}
        {% if block.settings.custom_filter_2 != blank %}
          <a class="ss__list__link btn btn--primary" href="{{ block.settings.custom_filter_2 }}">{{ block.settings.custom_filter_2_text }}</a>
        {% endif %}
        {% if block.settings.custom_filter_3 != blank %}
          <a class="ss__list__link btn btn--primary" href="{{ block.settings.custom_filter_3 }}">{{ block.settings.custom_filter_3_text }}</a>
        {% endif %}
      </div>
    {% endif %}
    {% if block.settings.filter_menu != blank %}
      {% assign filter = linklists[block.settings.filter_menu] %}
    
      {% assign parent_count = 0 %}
      {% for link in filter.links %}
        {% if link.links != blank %}
          {% assign parent_count = parent_count | plus: 1 %}
        {% endif %}
      {% endfor %}
    
      <div class="filter-menu">
          
        {% if parent_count < 2 %}
          {% if block.settings.filter_title %}
            <p class="filter-title">{{ block.settings.filter_title }}:</p>
          {% endif %}
          <!-- Inline links -->
          <div class="filter-inline">
            {% for link in filter.links %}
              <a href="#{{ link.url }}">{{ link.title }}</a>
            {% endfor %}
          </div>
    
        {% else %}
          <!-- Grouped dropdowns -->
          {% for link in filter.links %}
            {% if link.links != blank %}
              <div class="filter-group">
                <label class="filter-label">{{ link.title }}</label>
                <select class="filter-select">
                  <option value="#">Choose an option</option>
                  {% for child in link.links %}
                    <option value="{{ child.url }}">{{ child.title }}</option>
                  {% endfor %}
                </select>
              </div>
            {% endif %}
          {% endfor %}
        {% endif %}
      </div>
    
      <script>
        function updateHashFromAllDropdowns() {
          const selects = document.querySelectorAll('.filter-select');
          const values = [];
      
          selects.forEach(select => {
            const val = select.value;
            if (val && val !== '#' && !values.includes(val)) {
              values.push(val);
            }
          });
      
          if (values.length > 0) {
            window.location.hash = values.join('');
          } else {
            window.location.hash = '';
          }
        }
      
        // Attach to all dropdowns
        document.addEventListener('DOMContentLoaded', function() {
          const selects = document.querySelectorAll('.filter-select');
          selects.forEach(select => {
            select.addEventListener('change', updateHashFromAllDropdowns);
          });
        });
      </script>
    {% endif %}
  </div>
</div>